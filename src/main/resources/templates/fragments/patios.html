<!DOCTYPE html>
<html lang="pt-BR" data-theme="light" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/base :: layout(~{::title}, ~{::main}, ~{::scripts})}">
<head>
    <title th:text="#{patio.cadastro.titulo}">Cadastro de Pátio</title>
</head>
<body>
<main class="flex-grow p-6 bg-[#242529] overflow-y-auto">
    <div class="flex items-center justify-between mb-6">
        <div>
            <h2 class="text-2xl font-bold text-white" th:text="#{patio.cadastro.titulo}">Cadastro de Pátio</h2>
            <p class="text-sm text-gray-400 mt-1" th:text="#{patio.cadastro.subtitulo}">Preencha os dados do pátio</p>
        </div>
        <div class="flex items-center space-x-4">
            <a th:href="@{/index}" class="btn btn-outline border-white text-white hover:bg-white/10">
                <span th:text="#{patio.botao.voltar}">Voltar</span>
            </a>
        </div>
    </div>

    <div class="bg-[var(--color-black)] rounded-2xl p-6 shadow-2xl border border-[var(--color-primary)] max-w-5xl mx-auto">
        <form th:action="@{/patios}" th:object="${patio}" method="post" id="patio-form" class="space-y-6">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <input type="hidden" th:field="*{idPatio}" />

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="form-control w-full">
                    <label class="label">
                        <span class="label-text text-white" th:text="#{patio.nome.label}">Nome do Pátio <span class="text-red-500">*</span></span>
                    </label>
                    <input type="text" th:field="*{nmPatio}" maxlength="50"
                           class="input input-bordered w-full bg-[#2a2a2e] text-white border-gray-700 focus:border-[var(--color-primary)]"
                           th:placeholder="#{patio.nome.placeholder}" required />
                    <div th:if="${#fields.hasErrors('nmPatio')}" th:errors="*{nmPatio}" class="text-sm text-red-400 mt-1"></div>
                </div>

                <div class="form-control w-full">
                    <label class="label">
                        <span class="label-text text-white" th:text="#{patio.descricao.label}">Descrição</span>
                    </label>
                    <input type="text" th:field="*{dsPatio}" maxlength="100"
                           class="input input-bordered w-full bg-[#2a2a2e] text-white border-gray-700 focus:border-[var(--color-primary)]"
                           th:placeholder="#{patio.descricao.placeholder}" />
                </div>

                <div class="form-control w-full">
                    <label class="label">
                        <span class="label-text text-white" th:text="#{patio.filiais.label}">Filial <span class="text-red-500">*</span></span>
                    </label>
                    <select th:field="*{filiais.id}" class="select select-bordered w-full bg-[#2a2a2e] text-white border-gray-700 focus:border-[var(--color-primary)]" required>
                        <option value="" disabled selected th:text="#{patio.selecioneFilial}">Selecione uma filial</option>
                        <option th:each="f : ${filiais}" th:value="${f.id}" th:text="${f.nome}"></option>
                    </select>


                    <div class="form-control w-full mt-5" >
                        <label class="label cursor-pointer">
                            <span class="label-text text-white" th:text="#{patio.aberto.label}">Aberto</span>
                            <input type="checkbox" th:field="*{flAberto}" value="S" class="checkbox checkbox-primary ml-2"/>
                        </label>
                    </div>
                </div>
            </div>

            <p class="text-xs text-gray-400 mt-2" th:text="#{patio.campos.obrigatorios}">Campos com <span class="text-red-500">*</span> são obrigatórios.</p>

            <div class="mt-6 flex justify-end space-x-4">
                <button type="reset" class="btn btn-outline text-white border-white hover:bg-white/10" th:text="#{patio.limpar.botao}">Limpar</button>
                <button type="submit" class="btn bg-[var(--color-primary)] text-white hover:bg-green-600" th:text="#{patio.salvar.botao}">Salvar Pátio</button>
            </div>
        </form>
    </div>
</main>

<script th:inline="javascript" th:fragment="scripts">
    (function(){
        const form = document.getElementById('patio-form');
        if(!form) return;
        form.addEventListener('submit', function(e){
            // disable submit to prevent double-posting
            const submitBtn = form.querySelector('button[type=submit]');
            if(submitBtn){ submitBtn.disabled = true; submitBtn.classList.add('opacity-50'); }
        });
    })();
</script>
</body>
</html>